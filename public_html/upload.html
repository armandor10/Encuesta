<!DOCTYPE html>
  <html>
    <head>
      <!--Let browser know website is optimized for mobile-->
      <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
      <meta charset="utf-8">

      <!--Import Google Icon Font-->
      <link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

      <script src="js/vendor/angular.js"></script>
      <script src="js/vendor/ng-file-upload-shim.js"></script>
      <script src="js/vendor/ng-file-upload.js"></script>

      <!--Import jQuery before materialize.js-->
      <script type="text/javascript" src="js/vendor/jquery.min.js"></script>
      <script type="text/javascript" src="js/vendor/materialize2.js"></script>

      <style type="text/css">
        .thumb {
            width: 24px;
            height: 24px;
            float: none;
            position: relative;
            top: 7px;
        }

        form .progress {
            line-height: 15px;
        }
        }

        .progress {
            display: inline-block;
            width: 100px;
            border: 10px groove #CCC;
        }

        .progress div {
            font-size: smaller;
            background: orange;
            width: 0;
        }
      </style>

    </head>
    <body ng-app="fileUpload" ng-controller="MyCtrl">
      <form name="myForm">
        <fieldset>
          <legend>Upload on form submit</legend>
          <br>Archivo:
          <input type="file" ngf-select ng-model="picFile" name="file"    
                 accept=".csv" ngf-max-size="100MB" required
                 ngf-model-invalid="errorFiles">
          <i ng-show="myForm.file.$error.required">*required</i><br>
          <i ng-show="myForm.file.$error.maxSize">File too large 
              {{errorFiles[0].size / 1000000|number:1}}MB: max 100M</i>
          <button ng-click="picFile = null" ng-show="picFile">Remove</button>
          <br>
          <br>
          <button ng-disabled="!myForm.$valid" 
                  ng-click="uploadPic(picFile)">Submit</button>
          <span class="progress" ng-show="picFile.progress >= 0">
            <div style="width:{{picFile.progress}}%" 
                ng-bind="picFile.progress + '%'"></div>
          </span>
          <span ng-show="picFile.result">Carga Exitosa</span>
          <span class="err" ng-show="errorMsg">{{errorMsg}}</span>
        </fieldset>
        <br>
      </form>

      <script type="text/javascript">
        //inject angular file upload directives and services.
        var app = angular.module('fileUpload', ['ngFileUpload']);

        app.controller('MyCtrl', ['$scope', 'Upload', '$timeout', function ($scope, Upload, $timeout) {
            $scope.uploadPic = function(file) {
            file.upload = Upload.upload({
              url: '../public/Matriculado/upload',
              data: {file: file, username: 'm'},
            });

            file.upload.then(function (response) {
              $timeout(function () {
                console.log(response);
                file.result = response.data;
              });
            }, function (response) {
              if (response.status > 0)
                $scope.errorMsg = response.status + ': ' + response.data;
            }, function (evt) {
              // Math.min is to fix IE which reports 200% sometimes
              file.progress = Math.min(100, parseInt(100.0 * evt.loaded / evt.total));
            });
            }
        }]);

      </script>
    </body>

 </html>
